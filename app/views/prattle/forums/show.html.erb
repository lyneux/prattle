<h1><%= link_to "Forums", prattle.root_path %> / <%= link_to @forum.category.name, @forum.category %> / <%= @forum.name %></h1>
<p><%= @forum.description %></p>
<p>
	<% if prattle_admin? %>
		<%= link_to 'Edit Forum', edit_category_forum_path(@forum.category, @forum), class: "btn btn-sm btn-danger" %>
	<% end %>
	<%= link_to 'New Topic', new_category_forum_topic_path(@forum.category, @forum), class: "btn btn-sm btn-primary" %>
	<%= link_to 'Mark All Posts As Read', category_forum_mark_as_read_path(@forum.category, @forum), class: "btn btn-sm btn-primary", onclick: "$(this).button('loading');" %>
</p>

<% if @forum.topics.empty? %>
	<p>There are no topics in this forum yet.</p>
<% else %>

	<%= will_paginate @topics, :renderer => BootstrapPagination::Rails, class: 'pagination-sm'  %>

	<table class="table table-striped table-condensed">
		<tbody>
		  <% @topics.each do |topic| %>
		    <tr>
		      <td>
		      	<h4>
		      		<%= link_to topic.subject, category_forum_topic_path(@forum.category, @forum, topic) %>
		      		<% if show_new_marker(topic) %>
		      			<span class="badge">
		      				<%= link_to_latest_unread_post(topic) %>
		      			</span>
		      		<% end %>
		      	</h4>
		      	Started by <%= topic.posts.first.user %>, <%= topic.posts.first.created_at.strftime("%d %B %Y") %>
		      </td>
		      <td>Last post by <%= topic.posts.last.user if topic.posts.last %><br/>
		      	on <%= topic.posts.last.created_at.strftime("%d %B %Y") if topic.posts.last %> - 
		      	<%= topic.posts.last.updated_at.strftime("%H:%M") if topic.posts.last %></td>
		      <td>
		      	<span class="badge"><%= topic.posts.count %></span> posts<br/>
		      	<span class="badge"><%= topic.view_count %></span> views
		      </td>
		    </tr>
		  <% end %>
		</tbody>
	</table>

	<%= will_paginate @topics, :renderer => BootstrapPagination::Rails, class: 'pagination-sm'  %>
	
<% end %>

<p><%= link_to 'View Forums', category_forums_path(@forum.category), class: "btn btn-sm btn-primary"  %></p>